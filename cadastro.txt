<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carteirinha do Piloto - Downhill PE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        
        body { 
            background: #f0f2f5; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh; padding: 20px;
        }

        .card { 
            background: white; width: 100%; max-width: 450px; border-radius: 25px; 
            overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.15); border: 2px solid #003399;
            position: relative;
        }

        /* Topo da Carteirinha */
        .card-header { 
            background: #003399; color: white; padding: 30px 20px; text-align: center;
            border-bottom: 5px solid #ffcc00;
        }

        .profile-container {
            width: 130px; height: 130px; border-radius: 50%; border: 4px solid white;
            background: #fff; margin: 0 auto 15px; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        #view-foto { width: 100%; height: 100%; object-fit: cover; }
        #foto-padrao { font-size: 60px; color: #003399; }

        .card-header h2 { font-size: 20px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .badge-categoria { 
            display: inline-block; background: #ffcc00; color: #003399; 
            padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 12px; text-transform: uppercase;
        }

        /* Corpo */
        .card-body { padding: 25px; }
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .info-item { margin-bottom: 10px; }
        .info-item label { display: block; font-size: 10px; color: #888; text-transform: uppercase; font-weight: bold; }
        .info-item p { font-size: 14px; color: #333; font-weight: 600; }

        .medical-section {
            grid-column: span 2; background: #fff5f5; border: 1.5px dashed #e63946;
            padding: 15px; border-radius: 12px; margin-top: 10px;
        }
        .medical-section h4 { color: #e63946; font-size: 11px; margin-bottom: 8px; text-transform: uppercase; display: flex; align-items: center; gap: 5px; }

        /* Botões */
        .actions { display: flex; gap: 10px; width: 100%; max-width: 450px; margin-top: 20px; }
        
        .btn {
            flex: 1; padding: 15px; border: none; border-radius: 12px; font-weight: bold; 
            cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.3s;
        }
        
        .btn-print { background: #003399; color: white; }
        .btn-logout { background: #ddd; color: #666; text-decoration: none; }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }

        /* REGRAS PARA IMPRESSÃO */
        @media print {
            body { background: white; padding: 0; }
            .actions { display: none; } /* Esconde os botões na impressão */
            .card { box-shadow: none; border: 1px solid #003399; margin: 0; }
            .card-header { -webkit-print-color-adjust: exact; } /* Garante que a cor saia na impressora */
        }
    </style>
</head>
<body>

    <div class="card" id="carteirinha">
        <div class="card-header">
            <div class="profile-container">
                <img id="view-foto" src="" style="display: none;">
                <i id="foto-padrao" class="fas fa-user-ninja"></i>
            </div>
            <h2 id="view-nome">Nome do Piloto</h2>
            <span class="badge-categoria" id="view-categoria">Categoria</span>
        </div>

        <div class="card-body">
            <div class="info-grid">
                <div class="info-item">
                    <label>CPF</label>
                    <p id="view-cpf">--</p>
                </div>
                <div class="info-item">
                    <label>Nascimento</label>
                    <p id="view-nasc">--</p>
                </div>
                <div class="info-item">
                    <label>Cartão SUS</label>
                    <p id="view-sus">--</p>
                </div>
                <div class="info-item">
                    <label>Tipo Sanguíneo</label>
                    <p id="view-sangue" style="color: #e63946; font-size: 18px;">--</p>
                </div>
                <div class="medical-section">
                    <h4><i class="fas fa-biohazard"></i> Alergias / Observações</h4>
                    <p id="view-alergia" style="font-size: 13px; color: #555;">--</p>
                </div>
            </div>
        </div>
    </div>

    <div class="actions">
        <button class="btn btn-print" onclick="window.print()">
            <i class="fas fa-print"></i> IMPRIMIR PDF
        </button>
        <a href="login.html" class="btn btn-logout">
            <i class="fas fa-sign-out-alt"></i> SAIR
        </a>
    </div>

    <script>
        const piloto = JSON.parse(localStorage.getItem('usuarioPiloto'));

        if (!piloto) {
            window.location.href = "login.html";
        } else {
            document.getElementById('view-nome').innerText = piloto.nome;
            document.getElementById('view-categoria').innerText = piloto.categoria;
            document.getElementById('view-cpf').innerText = piloto.cpf;
            document.getElementById('view-nasc').innerText = formatarData(piloto.nascimento);
            document.getElementById('view-sus').innerText = piloto.sus || "Não Informado";
            document.getElementById('view-sangue').innerText = piloto.sangue;
            document.getElementById('view-alergia').innerText = piloto.alergia || "Sem alergias relatadas.";

            if (piloto.foto) {
                const img = document.getElementById('view-foto');
                img.src = piloto.foto;
                img.style.display = "block";
                document.getElementById('foto-padrao').style.display = "none";
            }
        }

        function formatarData(data) {
            if(!data) return "--/--/----";
            const partes = data.split("-");
            return `${partes[2]}/${partes[1]}/${partes[0]}`;
        }
    </script>
</body>
</html>